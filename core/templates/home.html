{% extends 'base.html' %}
{% block content %}

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
  :root {
    --primary-color: #0056b3; /* Deep Medical Blue */
    --secondary-color: #17a2b8; /* Cyan/Teal */
    --accent-color: #ffca28; /* Warning/Stars */
    --light-bg: #f8f9fa;
    --dark-text: #2c3e50;
    --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
  }

   /* Services Section */
  .services {
    padding: 80px 20px;
    background: linear-gradient(135deg, var(--soft-white) 0%, #f1f5f9 100%);
    border-radius: 24px;
    margin: 40px 0;
  }
  .service-box {
    display: inline-flex;
    flex-direction: column;
    align-items: center;
    background: white;
    padding: 32px 24px;
    margin: 16px;
    border-radius: 20px;
    width: 280px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    border: 1px solid var(--light-gray);
    transition: all 0.4s ease;
    position: relative;
    overflow: hidden;
  }
  .service-box::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--primary-blue), var(--secondary-teal));
  }
  .service-box:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 40px rgba(14,165,233,0.15);
    border-color: var(--secondary-teal);
  }
  .service-box i {
    font-size: 3rem;
    background: linear-gradient(135deg, var(--primary-blue), var(--secondary-teal));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 16px;
  }


    /* Quick Links */
  .quick-link-card {
    border-radius: 20px;
    padding: 24px;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }
  .quick-link-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--primary-blue), var(--secondary-teal));
  }
  .quick-link-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.15);
  }

  body {
    font-family: 'Poppins', sans-serif;
    background-color: #f4f7f6;
    overflow-x: hidden;
  }

  /* --- Hero Section --- */
  .hero {
    background: linear-gradient(120deg, #05214d 0%, #0056b3 100%);
    position: relative;
    overflow: hidden;
    color: white;
    border-radius: 0 0 50px 50px; /* Modern curve at bottom */
    box-shadow: 0 10px 30px rgba(5, 33, 77, 0.4);
    margin-bottom: 3rem;
  }
  
  /* Decorative Circle in Hero */
  .hero::before {
    content: '';
    position: absolute;
    top: -50px;
    right: -50px;
    width: 300px;
    height: 300px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
  }

  .btn-hero {
    background: white;
    color: var(--primary-color);
    font-weight: 700;
    border-radius: 50px;
    padding: 12px 35px;
    transition: all 0.3s ease;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  }
  
  .btn-hero:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
    background: var(--secondary-color);
    color: white;
  }

  /* --- Carousel --- */
  .carousel-inner {
    border-radius: 20px;
    box-shadow: var(--card-shadow);
  }
  .carousel-item img {
    object-fit: cover;
    filter: brightness(0.9);
  }

  /* --- Info Cards (Floating Stats) --- */
  .info-section {
    display: grid; 
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 25px;
    margin: 60px 20px 60px 20px; /* Negative margin to overlap carousel slightly */
    position: relative; 
    z-index: 10;
  } 
  
  .info-card {
    background: white;
    border-radius: 20px;
    padding: 30px 20px;
    text-align: center;
    box-shadow: 0 15px 35px rgba(0,0,0,0.1);
    transition: all 0.4s ease;
    border-top: 5px solid var(--secondary-color);
    
  }
  
  .info-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 40px rgba(23, 162, 184, 0.3);
    
  }
  
  .info-card i {
    font-size: 2.5rem;
    color: var(--primary-color);
    margin-bottom: 15px;
    background-color: #f1f5f9;
    padding: 15px;
    border-radius: 50%;
    width: 80px;
    height: 80px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    
  }
  
  .info-card h3 {
    font-size: 1.2rem;
    font-weight: 700;
    margin-bottom: 10px;
    color: var(--dark-text);
  }
  
  .info-card p {
    font-size: 0.9rem;
    color: #6c757d;
  }

  /* --- Doctors Section --- */
  .section-title {
    font-weight: 800;
    color: var(--primary-color);
    text-transform: uppercase;
    letter-spacing: 1px;
    position: relative;
    display: inline-block;
    padding-bottom: 10px;
  }
  
  .section-title::after {
    content: '';
    width: 60px;
    height: 4px;
    background: var(--secondary-color);
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    border-radius: 2px;
  }

  

  .doctor-card {
    background: white;
    border: none;
    border-radius: 20px;
    overflow: hidden;
    transition: all 0.3s ease;
    box-shadow: var(--card-shadow);
  }
  
  .doctor-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.15);
  }

  .doctor-icon-box {
    width: 100px;
    height: 100px;
    margin: 0 auto;
    border-radius: 50%;
    background: linear-gradient(135deg, #e3f2fd, #bbdefb);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 50px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    border: 3px solid white;
  }

  .doctor-btn {
    border-radius: 30px !important;
    font-weight: 600;
    font-size: 0.9rem;
    padding: 8px 15px;
    transition: 0.3s;
  }
  
  .doctor-btn-primary {
    background: var(--primary-color);
    color: white;
    border: none;
  }
  .doctor-btn-primary:hover {
    background: #004494;
    color: white;
    transform: scale(1.05);
  }
  
  .doctor-btn-outline {
    border: 2px solid var(--primary-color);
    color: var(--primary-color);
    background: transparent;
  }
  .doctor-btn-outline:hover {
    background: var(--primary-color);
    color: white;
  }

  /* --- Services Section --- */
  .services {
    background: #ffffff;
    padding: 80px 0;
    margin-top: 50px;
    border-radius: 50px 50px 0 0;
  }
  
  .service-box {
    background: white;
    border: 1px solid #2319b0;
    padding: 30px;
    margin: 15px;
    border-radius: 20px;
    width: 260px;
    display: inline-block;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    overflow: hidden;
  }
  
  .service-box:hover {
    transform: scale(1.05);
    box-shadow: 0 15px 30px rgba(0, 86, 179, 0.15);
    border-color: var(--secondary-color);
  }
  
  .service-box::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 5px;
    background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
  }

  .service-box i {
    font-size: 3rem;
    background: -webkit-linear-gradient(45deg, var(--primary-color), var(--secondary-color));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 20px;
  }

  /* --- Marquee Images --- */
  .marquee-img {
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    margin: 0 10px;
    transition: transform 0.3s;
    border: none !important; /* Overriding previous inline styles */
  }
  .marquee-img:hover {
    transform: scale(1.05);
  }

  /* --- Bottom Nav Cards --- */
  .nav-card {
    border: none;
    border-radius: 15px;
    overflow: hidden;
    background: white;
    box-shadow: var(--card-shadow);
    transition: transform 0.3s;
  }
  .nav-card:hover {
    transform: translateY(-5px);
  }
  .nav-card h5 {
    font-weight: 700;
  }
  
  /* Modal Styling */
  .modal-content {
    border-radius: 20px;
    border: none;
  }
  .modal-header {
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    color: white;
    border-radius: 20px 20px 0 0;
  }
</style>

<div class="p-5 mb-5 rounded-3 hero">
  <div class="container-fluid py-5 text-center" style="position: relative; z-index: 2;">
    <h1 class="display-3 fw-bold mb-3">üè• Health Care Hospital</h1>
    <p class="col-md-8 mx-auto fs-5 mb-5 opacity-75">
      Your Health, Our Priority. Book appointments, manage records, and connect with expert doctors‚Äîall in one place.
    </p>
    <a class="btn btn-hero btn-lg px-5" 
       href="{% url 'appointment_book' %}"
       {% if not user.is_authenticated or user.role != 'PATIENT' %}
         onclick="alert('Patients only. Please login/register as Patient.'); return false;"
       {% endif %}>
       <i class="fas fa-calendar-check me-2"></i> Book Appointment
    </a>
  </div>
</div>

<div class="container">
    <div id="hospitalCarousel" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-inner shadow-lg">
        <div class="carousel-item active">
          <img src="https://images.pexels.com/photos/668300/pexels-photo-668300.jpeg" class="d-block w-100" height="450" alt="Hospital">
          <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded">
            <h5>State of the Art Facilities</h5>
          </div>
        </div>
        <div class="carousel-item">
          <img src="https://images.pexels.com/photos/1770818/pexels-photo-1770818.jpeg" class="d-block w-100" height="450" alt="Doctors">
           <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded">
            <h5>World Class Specialists</h5>
          </div>
        </div>
        <div class="carousel-item">
          <img src="https://images.pexels.com/photos/5452223/pexels-photo-5452223.jpeg" class="d-block w-100" height="450" alt="Patient Care">
           <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded">
            <h5>Compassionate Care</h5>
          </div>
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#hospitalCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon"></span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#hospitalCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon"></span>
      </button>
    </div>

    <div class="info-section">
        <div class="info-card">
            <i class="fas fa-user-md"></i>
            <h3>Expert Doctors</h3>
            <p>Our team of specialists provide world-class healthcare.</p>
        </div>
        <div class="info-card">
            <i class="fas fa-procedures"></i>
            <h3>24/7 Emergency</h3>
            <p>Round-the-clock emergency services with rapid response.</p>
        </div>
        <div class="info-card">
            <i class="fas fa-stethoscope"></i>
            <h3>Modern Facilities</h3>
            <p>Equipped with the latest medical technology.</p>
        </div>
        <div class="info-card">
            <i class="fas fa-heartbeat"></i>
            <h3>Patient Care</h3>
            <p>We ensure compassionate and personalized treatment.</p>
        </div>
    </div>

    <div class="text-center mb-5">
        <h3 class="section-title">Meet Our Experts</h3>
        <p class="text-muted mt-2">Dedicated professionals ready to help you</p>
    </div>

    <div class="row g-4 mb-5">
      {% if doctors %}
        {% for d in doctors %}
        <div class="col-12 col-md-6 col-lg-4">
          <div class="card h-100 text-center doctor-card p-4">
            <div class="card-body">

              <div class="mb-4">
                <div class="doctor-icon-box">
                  <span style="font-size: 50px;">üë®‚Äç‚öïÔ∏è</span>
                </div>
              </div>

              <h5 class="card-title fw-bold text-dark mb-1">
                Dr. {{ d.get_full_name|default:d.username }}
              </h5>

              <span class="badge bg-info bg-opacity-10 text-info mb-3 px-3 py-2 rounded-pill">
                {{ d.specialit|default:"General Physician" }}
              </span>

              {% if d.avg_rating %}
                <div class="mb-3">
                    <span style="color: #ffca28; font-size:1.1rem;">
                        {% for i in "12345" %}
                            {% if i|add:'0' <= d.avg_rating %}‚òÖ{% else %}‚òÜ{% endif %}
                        {% endfor %}
                    </span>
                    <div class="text-muted small">
                        ({{ d.avg_rating|floatformat:1 }}/5 ‚Äî {{ d.total_reviews }} reviews)
                    </div>
                </div>
              {% else %}
                <p class="text-muted small mb-3">‚≠ê No ratings yet</p>
              {% endif %}

              <div class="d-grid gap-2 mt-4">
                  <a href="{% url 'appointment_book' %}" class="btn doctor-btn doctor-btn-primary shadow-sm">
                    Book Appointment
                  </a>
                  
                  <div class="row g-2">
                    <div class="col-6">
                         <button class="btn doctor-btn doctor-btn-outline w-100"
                            data-bs-toggle="modal"
                            data-bs-target="#doctorModal{{ d.id }}">
                            Profile
                        </button>
                    </div>
                    <div class="col-6">
                        <a href="{% url 'rate_doctor' d.id %}" class="btn doctor-btn doctor-btn-outline w-100">
                           Rate
                        </a>
                    </div>
                  </div>
              </div>

            </div>
          </div>
        </div>

    <div class="modal fade" id="doctorModal{{ d.id }}" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content shadow-lg">

          <div class="modal-header">
            <h5 class="modal-title fw-bold">Dr. {{ d.get_full_name|default:d.username }}</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
          </div>

          <div class="modal-body p-4">
            <div class="row align-items-center">
              <div class="col-md-4 text-center mb-3 mb-md-0">
                {% if d.image %}
                  <img src="{{ d.image.url }}" class="img-fluid rounded-circle shadow border border-4 border-light" 
                       style="width:150px; height:150px; object-fit:cover;">
                {% else %}
                  <img src="/static/default.png" class="img-fluid rounded-circle shadow border border-4 border-light" 
                       style="width:150px;">
                {% endif %}
              </div>

              <div class="col-md-8">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item px-0"><strong>üéì Speciality:</strong> <span class="text-primary">{{ d.speciality|default:"Not provided" }}</span></li>
                    <li class="list-group-item px-0"><strong>üè• Work From:</strong> {{ d.work_from|default:"Not provided" }}</li>
                    <li class="list-group-item px-0"><strong>‚è≥ Experience:</strong> {% if d.experience %} {{ d.experience }} years {% else %} Not provided {% endif %}</li>
                    <li class="list-group-item px-0"><strong>üìú Qualification:</strong> {{ d.qualification|default:"Not provided" }}</li>
                    <li class="list-group-item px-0"><strong>‚ÑπÔ∏è About:</strong> <span class="text-muted">{{ d.about|default:"No bio available" }}</span></li>
                </ul>
              </div>
            </div>
          </div>

          <div class="modal-footer bg-light border-0">
            <a href="{% url 'appointment_book' %}" class="btn btn-primary px-4 rounded-pill">Confirm Booking</a>
            <button class="btn btn-secondary rounded-pill" data-bs-dismiss="modal">Close</button>
          </div>

        </div>
      </div>
    </div>

        {% endfor %}
      {% else %}
        <div class="col-12">
          <div class="alert alert-info shadow-sm text-center p-4 rounded-3">
             <i class="fas fa-info-circle me-2"></i> No approved doctors yet. Please check back later.
          </div>
        </div>
      {% endif %}
    </div>

</div>

<!-- !-- Services Section -->
<h2 class="text-center mb-5 fw-bold" 
    style="font-size: 2.8rem; color: var(--primary-color);">
    üåü Our Services
</h2>

  <div class="text-center">
    <div class="service-box">
      <i class="fas fa-x-ray"></i>
      <h4 class="fw-bold mb-3" style="color: var(--dark-gray);">Diagnostics</h4>
      <p class="text-muted mb-0">Advanced imaging & lab services for accurate results.</p>
    </div>
    <div class="service-box">
      <i class="fas fa-syringe"></i>
      <h4 class="fw-bold mb-3" style="color: var(--dark-gray);">Vaccinations</h4>
      <p class="text-muted mb-0">Comprehensive immunization programs for all ages.</p>
    </div>
    <div class="service-box">
      <i class="fas fa-ambulance"></i>
      <h4 class="fw-bold mb-3" style="color: var(--dark-gray);">Ambulance</h4>
      <p class="text-muted mb-0">Quick and reliable emergency ambulance support.</p>
    </div>
    <div class="service-box">
      <i class="fas fa-clinic-medical"></i>
      <h4 class="fw-bold mb-3" style="color: var(--dark-gray);">Outpatient</h4>
      <p class="text-muted mb-0">Specialized OPD services for your convenience.</p>
    </div>
  </div>
</section>

<!-- Enhanced Doctors Marquee -->
<section class="mx-3 mb-5">
  <h2 class="text-center mb-4 fw-bold" style="font-size: 2.2rem; color: var(--primary-blue);">üë• Our Medical Team</h2>
  <marquee behavior="alternate" scrollamount="10">
    <div class="d-flex align-items-center">
      <img src="https://plus.unsplash.com/premium_photo-1702598525684-fe2f8b75eb62?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.1.0" style="border-radius:16px; margin:0 15px; border: 3px solid rgba(255,255,255,0.3);" width="220" height="280" alt="Doctor">
      <img src="https://images.unsplash.com/photo-1612531386530-97286d97c2d2?w=500&auto=format&fit=crop&q=60" style="border-radius:16px; margin:0 15px; border: 3px solid rgba(255,255,255,0.3);" width="220" height="280" alt="Doctor">
      <img src="https://media.istockphoto.com/id/1394769128/photo/nurse-with-medical-file-at-hospital.webp?a=1&b=1&s=612x612&w=0&k=20&c=_WDw4-j4RF0rEDyinLaFz9nlxu43C6vB1m3ThPfBPYE=" style="border-radius:16px; margin:0 15px; border: 3px solid rgba(255,255,255,0.3);" width="220" height="280" alt="Doctor">
      <img src="https://plus.unsplash.com/premium_photo-1661699733041-a4e02693adf5?w=500&auto=format&fit=crop&q=60" style="border-radius:16px; margin:0 15px; border: 3px solid rgba(255,255,255,0.3);" width="220" height="280" alt="Doctor">
      <img src="https://plus.unsplash.com/premium_photo-1661764878654-3d0fc2eefcca?w=500&auto=format&fit=crop&q=60" style="border-radius:16px; margin:0 15px; border: 3px solid rgba(255,255,255,0.3);" width="220" height="280" alt="Doctor">
      <img src="https://plus.unsplash.com/premium_photo-1702598773834-be6d566bb57f?w=500&auto=format&fit=crop&q=60" style="border-radius:16px; margin:0 15px; border: 3px solid rgba(255,255,255,0.3);" width="220" height="280" alt="Doctor">
      <img src="https://plus.unsplash.com/premium_photo-1661778976948-0cbf766dc0e8?w=500&auto=format&fit=crop&q=60" style="border-radius:16px; margin:0 15px; border: 3px solid rgba(255,255,255,0.3);" width="220" height="280" alt="Doctor">
      <img src="https://images.unsplash.com/photo-1659353887238-d6c8506a1b5b?w=500&auto=format&fit=crop&q=60" style="border-radius:16px; margin:0 15px; border: 3px solid rgba(255,255,255,0.3);" width="220" height="280" alt="Doctor">
    </div>
  </marquee>
</section>

<!-- Quick Links -->
<section class="container mb-5">
  <h2 class="text-center mb-5 fw-bold" style="font-size: 2.2rem; color: var(--dark-gray);">üöÄ Quick Links</h2>
  <div class="row g-4">
    <div class="col-12 col-md-4">
      <a href="{% url 'about' %}" class="text-decoration-none">
        <div class="card h-100 quick-link-card glass-card text-center p-4">
          <div class="card-body">
            <h5 class="card-title fw-bold mb-3" style="color: var(--primary-blue);">About Us</h5>
            <p class="card-text text-muted mb-0">Learn more about our hospital and services.</p>
          </div>
        </div>
      </a>
    </div>
    <div class="col-12 col-md-4">
      <a href="{% url 'gallery' %}" class="text-decoration-none">
        <div class="card h-100 quick-link-card glass-card text-center p-4">
          <div class="card-body">
            <h5 class="card-title fw-bold mb-3" style="color: var(--accent-green);">Gallery</h5>
            <p class="card-text text-muted mb-0">Explore our modern facilities & events.</p>
          </div>
        </div>
      </a>
    </div>
    <div class="col-12 col-md-4">
      <a href="{% url 'appointment_book' %}" class="text-decoration-none">
        <div class="card h-100 quick-link-card glass-card text-center p-4">
          <div class="card-body">
            <h5 class="card-title fw-bold mb-3" style="color: var(--success-green);">Book Appointment</h5>
            <p class="card-text text-muted mb-0">Easy online booking for patients.</p>
          </div>
        </div>
      </a>
    </div>
  </div>
</section>

{% endblock %}